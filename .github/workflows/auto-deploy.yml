name: ImplantaÃ§Ã£o automÃ¡tica por ramificaÃ§Ã£o

on:
  push:
    branches:
      - dev
      - hml
      - prd
      - main

jobs:
  implantar:
    runs-on: self-hosted

    steps:
      - name: ðŸ” Determinar ambiente automaticamente
        run: |
          if [[ "${GITHUB_REF##*/}" == "desenvolvedor" ]]; then AMBIENTE=dev;
          elif [[ "${GITHUB_REF##*/}" == "hml" ]]; then AMBIENTE=hml;
          elif [[ "${GITHUB_REF##*/}" == "principal" ]]; then AMBIENTE=prd;
          elif [[ "${GITHUB_REF##*/}" == "serviÃ§o" ]]; then AMBIENTE=servico;
          fi
          echo "AMBIENTE=$AMBIENTE" >> $GITHUB_ENV

      - name: ðŸš€ Deploy automÃ¡tico
        run: |
          echo "Deploy automÃ¡tico para $AMBIENTE..."
          sudo rsync -av --delete ./ /var/www/venditudo/
          sudo systemctl restart nginx
