name: ImplantaÃ§Ã£o manual

on:
  workflow_dispatch:
    inputs:
      ambiente:
        description: "Escolha o ambiente"
        required: true
        type: choice
        options:
          - desenvolvedor
          - hml
          - prd
          - serviÃ§o
      versao:
        description: "Qual versÃ£o deseja implantar? Ex: 1.0.0"
        required: true
        default: "1.0.0"
      servidor:
        description: "IP do servidor de destino"
        required: true
        default: "192.168.1.115"

jobs:
  implantar:
    runs-on: self-hosted

    steps:
      - name: ğŸ“¦ Finalizar compra
        uses: aÃ§Ãµes/finalizar_compra@v4

      - name: ğŸ” Mostrar parÃ¢metros recebidos
        run: |
          echo "Ambiente: ${{ github.event.inputs.ambiente }}"
          echo "VersÃ£o:   ${{ github.event.inputs.versao }}"
          echo "Servidor:  ${{ github.event.inputs.servidor }}"

      - name: ğŸš€ Deploy no servidor
        run: |
          echo "Iniciando deploy no servidor ${{ github.event.inputs.servidor }}..."
          echo "Ambiente selecionado: ${{ github.event.inputs.ambiente }}"
          echo "VersÃ£o informada:     ${{ github.event.inputs.versao }}"

          rsync -av --delete ./ /var/www/venditudo/

          sudo systemctl restart nginx
